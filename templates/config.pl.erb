<% if @authoritative_conf then -%>
# This file managed by Puppet.
# All changes will be overwritten at the next Puppet run.
<% else -%>
# This file initially generated by Puppet.
# Manual and/or CGI changes will *not* be overwritten.
# To reset this file to the defaults, simply remove the file and re-run puppet
<% end -%>

# Comments can be found in /etc/BackupPC/config.pl.example

$Conf{ServerHost} = '<%= @fqdn %>';
$Conf{ServerPort} = -1;
$Conf{ServerMesgSecret} = '';
$Conf{MyPath} = '/bin';
$Conf{UmaskMode} = <%= @umask_mode %>;
$Conf{WakeupSchedule} = [
  <%= Array(@wakeup_schedule).join(",\n") %>
];
$Conf{MaxBackups} = <%= @max_backups %>;
$Conf{MaxUserBackups} = <%= @max_user_backups %>;
$Conf{MaxPendingCmds} = <%= @max_pending_commands %>;
$Conf{MaxBackupPCNightlyJobs} = <%= @max_backup_pc_nightly_jobs %>;
$Conf{BackupPCNightlyPeriod} = <%= @backup_pc_nightly_period %>;
$Conf{MaxOldLogFiles} = <%= @max_old_log_files %>;
$Conf{DfPath} = '/bin/df';
$Conf{DfCmd} = '$dfPath $topDir';
$Conf{SplitPath} = '/usr/bin/split';
$Conf{ParPath} = undef;
$Conf{CatPath} = '/bin/cat';
$Conf{GzipPath} = '/bin/gzip';
$Conf{Bzip2Path} = '/usr/bin/bzip2';
$Conf{DfMaxUsagePct} = <%= @df_max_usage_percent %>;
$Conf{TrashCleanSleepSec} = <%= @trash_clean_sleep_sec %>;
$Conf{DHCPAddressRanges} = [];
$Conf{BackupPCUser} = 'backuppc';
$Conf{TopDir} = '<%= @data_dir %>/';
$Conf{ConfDir} = '/etc/BackupPC/';
$Conf{LogDir} = '/var/log/BackupPC';
$Conf{InstallDir} = '/opt/BackupPC';
$Conf{CgiDir} = '/opt/BackupPC/sbin/';
$Conf{BackupPCUserVerify} = '1';
$Conf{HardLinkMax} = 31999;
$Conf{PerlModuleLoad} = undef;
$Conf{ServerInitdPath} = undef;
$Conf{ServerInitdStartCmd} = '';
$Conf{FullPeriod} = '<%= @full_period %>';
$Conf{IncrPeriod} = '<%= @incr_period %>';
$Conf{FullKeepCnt} = [
  <%= Array(@full_keep_cnt).join(",\n") %>
];
$Conf{FullKeepCntMin} = <%= @full_keep_cnt_min %>;
$Conf{FullAgeMax} = <%= @full_age_max %>;
$Conf{IncrKeepCnt} = <%= @incr_keep_cnt %>;
$Conf{IncrKeepCntMin} = <%= @incr_keep_cnt_min %>;
$Conf{IncrAgeMax} = <%= @incr_age_max %>;
$Conf{IncrLevels} = [
  <%= Array(@incr_levels).join(",\n") %>
];
$Conf{BackupsDisable} = 0;
$Conf{PartialAgeMax} = <%= @partial_age_max %>;
$Conf{IncrFill} = '0';
$Conf{RestoreInfoKeepCnt} = <%= @restore_info_keep_cnt %>;
$Conf{ArchiveInfoKeepCnt} = <%= @archive_info_keep_cnt %>;
$Conf{BackupFilesOnly} = {};
$Conf{BackupFilesExclude} = {};
$Conf{BlackoutBadPingLimit} = <%= @blackout_bad_ping_limit %>;
$Conf{BlackoutGoodCnt} = <%= @blackout_good_cnt %>;
$Conf{BlackoutPeriods} = [
  {
    'hourEnd' => '<%= @blackout_period_hour_end %>',
    'weekDays' => [
      <%= Array(@blackout_period_weekdays).join(",\n") %>
    ],
    'hourBegin' => '<%= @blackout_period_hour_begin %>'
  }
];
$Conf{BackupZeroFilesIsFatal} = '<%= @backup_zero_files_is_fatal %>';
$Conf{XferMethod} = 'rsync';
$Conf{XferLogLevel} = <%= @xfer_log_level %>;
<% if not @client_charset.eql?('nil') then -%>
$Conf{ClientCharset} = '<%= @client_charset %>';
<% end -%>
$Conf{ClientCharsetLegacy} = '<%= @client_charset_legacy %>';
$Conf{SmbShareName} = [
  'C$'
];
$Conf{SmbShareUserName} = '';
$Conf{SmbSharePasswd} = '';
$Conf{SmbClientPath} = '/usr/bin/smbclient';
$Conf{SmbClientFullCmd} = '$smbClientPath \\\\$host\\$shareName $I_option -U $userName -E -N -d 1 -c tarmode\\ full -Tc$X_option - $fileList';
$Conf{SmbClientIncrCmd} = '$smbClientPath \\\\$host\\$shareName $I_option -U $userName -E -N -d 1 -c tarmode\\ full -TcN$X_option $timeStampFile - $fileList';
$Conf{SmbClientRestoreCmd} = '$smbClientPath \\\\$host\\$shareName $I_option -U $userName -E -N -d 1 -c tarmode\\ full -Tx -';
$Conf{TarShareName} = [
  '/'
];
$Conf{TarClientCmd} = '$sshPath -q -x -n -l root $host env LC_ALL=C $tarPath -c -v -f - -C $shareName+ --totals';
$Conf{TarFullArgs} = '$fileList+';
$Conf{TarIncrArgs} = '--newer=$incrDate+ $fileList+';
$Conf{TarClientRestoreCmd} = '$sshPath -q -x -l root $host env LC_ALL=C $tarPath -x -p --numeric-owner --same-owner -v -f - -C $shareName+';
$Conf{TarClientPath} = '/bin/gtar';
$Conf{RsyncClientPath} = '/usr/bin/rsync';
$Conf{RsyncClientCmd} = '$sshPath -o StrictHostKeyChecking=no -q -x -l bpc_user $host sudo $rsyncPath $argList+';
$Conf{RsyncClientRestoreCmd} = '$sshPath -o StrictHostKeyChecking=no -q -x -l bpc_user $host sudo $rsyncPath $argList+';
$Conf{RsyncShareName} = [
  '/'
];
$Conf{RsyncdClientPort} = 873;
$Conf{RsyncdUserName} = '';
$Conf{RsyncdPasswd} = '';
$Conf{RsyncdAuthRequired} = '1';
$Conf{RsyncCsumCacheVerifyProb} = '0.01';
$Conf{RsyncArgs} = [
  '--numeric-ids',
  '--perms',
  '--owner',
  '--group',
  '-D',
  '--links',
  '--hard-links',
  '--times',
  '--block-size=2048',
  '--recursive'
];
$Conf{RsyncRestoreArgs} = [
  '--numeric-ids',
  '--perms',
  '--owner',
  '--group',
  '-D',
  '--links',
  '--hard-links',
  '--times',
  '--block-size=2048',
  '--relative',
  '--ignore-times',
  '--recursive'
];
$Conf{BackupPCdShareName} = '/';
$Conf{BackupPCdPath} = '';
$Conf{BackupPCdCmd} = '$bpcdPath $host $shareName $poolDir XXXX $poolCompress $topDir/pc/$client/new';
$Conf{BackupPCdRestoreCmd} = '$bpcdPath TODO';
$Conf{ArchiveDest} = '/tmp';
$Conf{ArchiveComp} = 'gzip';
$Conf{ArchivePar} = '<%= @archive_parity %>';
$Conf{ArchiveSplit} = <%= @archive_split %>;
$Conf{ArchiveClientCmd} = '$Installdir/bin/BackupPC_archiveHost $tarCreatePath $splitpath $parpath $host $backupnumber $compression $compext $splitsize $archiveloc $parfile *';
$Conf{SshPath} = '/usr/bin/ssh';
$Conf{NmbLookupPath} = '/usr/bin/nmblookup';
$Conf{NmbLookupCmd} = '$nmbLookupPath -A $host';
$Conf{NmbLookupFindHostCmd} = '$nmbLookupPath $host';
$Conf{FixedIPNetBiosNameCheck} = '0';
$Conf{PingPath} = '<%= @ping_path %>';
$Conf{PingCmd} = '$pingPath -c 1 -w 3 $host';
$Conf{PingMaxMsec} = <%= @ping_max_msec %>;
$Conf{CompressLevel} = <%= @compress_level %>;
$Conf{ClientTimeout} = <%= @client_timeout %>;
$Conf{MaxOldPerPCLogFiles} = <%= @max_old_per_pc_log_files %>;
$Conf{DumpPreUserCmd} = undef;
$Conf{DumpPostUserCmd} = undef;
$Conf{DumpPreShareCmd} = undef;
$Conf{DumpPostShareCmd} = undef;
$Conf{RestorePreUserCmd} = undef;
$Conf{RestorePostUserCmd} = undef;
$Conf{ArchivePreUserCmd} = undef;
$Conf{ArchivePostUserCmd} = undef;
$Conf{UserCmdCheckStatus} = '0';
$Conf{ClientNameAlias} = undef;
$Conf{SendmailPath} = '/usr/sbin/sendmail';
$Conf{EMailNotifyMinDays} = '<%= @email_notify_min_days %>';
$Conf{EMailFromUserName} = 'backuppc';
$Conf{EMailAdminUserName} = 'backuppc';
$Conf{EMailUserDestDomain} = '';
$Conf{EMailNoBackupEverSubj} = undef;
$Conf{EMailNoBackupEverMesg} = undef;
$Conf{EMailNotifyOldBackupDays} = 7;
$Conf{EMailNoBackupRecentSubj} = undef;
$Conf{EMailNoBackupRecentMesg} = undef;
$Conf{EMailNotifyOldOutlookDays} = 5;
$Conf{EMailOutlookBackupSubj} = undef;
$Conf{EMailOutlookBackupMesg} = undef;
$Conf{EMailHeaders} = 'MIME-Version: 1.0
Content-Type: text/plain; charset="iso-8859-1"
';
<% if not @cgi_admin_user_group.eql?('nil') then -%>
$Conf{CgiAdminUserGroup} = '<%= @cgi_admin_user_group %>';
<% end -%>
$Conf{CgiAdminUsers} = '<%= @cgi_admin_users %>';
$Conf{CgiURL} = 'https://<%= @fqdn %>/BackupPC';
$Conf{Language} = '<%= @conf_language %>';
$Conf{CgiUserHomePageCheck} = '';
$Conf{CgiUserUrlCreate} = 'mailto:%s';
$Conf{CgiDateFormatMMDD} = <%= @cgi_date_format_mmdd %>;
$Conf{CgiNavBarAdminAllHosts} = '1';
$Conf{CgiSearchBoxEnable} = '1';
$Conf{CgiNavBarLinks} = [
  {
    'link' => '?action=view&type=docs',
    'lname' => 'Documentation',
    'name' => undef
  },
  {
    'link' => 'http://backuppc.wiki.sourceforge.net',
    'lname' => undef,
    'name' => 'Wiki'
  },
  {
    'link' => 'http://backuppc.sourceforge.net',
    'lname' => undef,
    'name' => 'SourceForge'
  }
];
$Conf{CgiStatusHilightColor} = {
  'Reason_backup_failed' => '#ffcccc',
  'Reason_backup_done' => '#ccffcc',
  'Reason_backup_canceled_by_user' => '#ff9900',
  'Reason_no_ping' => '#ffff99',
  'Disabled_OnlyManualBackups' => '#d1d1d1',
  'Status_backup_in_progress' => '#66cc99',
  'Disabled_AllBackupsDisabled' => '#d1d1d1'
};
$Conf{CgiHeaders} = '<meta http-equiv="pragma" content="no-cache">';
$Conf{CgiImageDir} = '/usr/share/BackupPC/html/';
$Conf{CgiExt2ContentType} = {};
$Conf{CgiImageDirURL} = '/BackupPC/images';
$Conf{CgiCSSFile} = 'BackupPC_stnd.css';
$Conf{CgiUserConfigEditEnable} = '<%= @cgi_user_config_edit_enable %>';
$Conf{CgiUserConfigEdit} = {
  'EMailOutlookBackupSubj' => '1',
  'ClientCharset' => '1',
  'TarFullArgs' => '1',
  'RsyncdPasswd' => '1',
  'IncrKeepCnt' => '1',
  'PartialAgeMax' => '1',
  'FixedIPNetBiosNameCheck' => '1',
  'SmbShareUserName' => '1',
  'EMailFromUserName' => '1',
  'ArchivePreUserCmd' => '0',
  'PingCmd' => '0',
  'FullAgeMax' => '1',
  'PingMaxMsec' => '1',
  'CompressLevel' => '1',
  'DumpPreShareCmd' => '0',
  'BackupFilesOnly' => '1',
  'EMailNotifyOldBackupDays' => '1',
  'EMailAdminUserName' => '1',
  'RsyncCsumCacheVerifyProb' => '1',
  'BlackoutPeriods' => '1',
  'NmbLookupFindHostCmd' => '0',
  'MaxOldPerPCLogFiles' => '1',
  'TarClientCmd' => '0',
  'EMailNotifyOldOutlookDays' => '1',
  'SmbSharePasswd' => '1',
  'SmbClientIncrCmd' => '0',
  'FullKeepCntMin' => '1',
  'RsyncArgs' => '1',
  'ArchiveComp' => '1',
  'TarIncrArgs' => '1',
  'EMailUserDestDomain' => '1',
  'TarClientPath' => '0',
  'RsyncClientCmd' => '0',
  'IncrFill' => '1',
  'RestoreInfoKeepCnt' => '1',
  'UserCmdCheckStatus' => '0',
  'RsyncdClientPort' => '1',
  'IncrAgeMax' => '1',
  'RsyncdUserName' => '1',
  'RsyncRestoreArgs' => '1',
  'ClientCharsetLegacy' => '1',
  'SmbClientFullCmd' => '0',
  'ArchiveInfoKeepCnt' => '1',
  'BackupZeroFilesIsFatal' => '1',
  'EMailNoBackupRecentMesg' => '1',
  'FullKeepCnt' => '1',
  'TarShareName' => '1',
  'EMailNoBackupEverSubj' => '1',
  'TarClientRestoreCmd' => '0',
  'EMailNoBackupRecentSubj' => '1',
  'ArchivePar' => '1',
  'XferLogLevel' => '1',
  'ArchiveDest' => '1',
  'ClientTimeout' => '1',
  'EMailNotifyMinDays' => '1',
  'RsyncdAuthRequired' => '1',
  'SmbClientRestoreCmd' => '0',
  'ClientNameAlias' => '0',
  'DumpPostShareCmd' => '0',
  'IncrLevels' => '1',
  'EMailOutlookBackupMesg' => '1',
  'BlackoutBadPingLimit' => '1',
  'BackupFilesExclude' => '1',
  'FullPeriod' => '1',
  'ArchivePostUserCmd' => '0',
  'RsyncClientRestoreCmd' => '0',
  'IncrPeriod' => '1',
  'RsyncShareName' => '1',
  'RestorePostUserCmd' => '0',
  'BlackoutGoodCnt' => '1',
  'ArchiveClientCmd' => '0',
  'ArchiveSplit' => '1',
  'XferMethod' => '1',
  'NmbLookupCmd' => '0',
  'BackupsDisable' => '1',
  'SmbShareName' => '1',
  'RestorePreUserCmd' => '0',
  'IncrKeepCntMin' => '1',
  'EMailNoBackupEverMesg' => '1',
  'EMailHeaders' => '1',
  'DumpPreUserCmd' => '0',
  'RsyncClientPath' => '0',
  'DumpPostUserCmd' => '0'
};
